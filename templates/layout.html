<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script> -->

    <link href="/static/styles.css" rel="stylesheet">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">

    <title>Wisp: {% block title %}{% endblock %}</title>
    <script>
        function dropDown() {
            document.getElementById("profile-dropdown").classList.toggle("show");
            document.getElementById("profile-button").classList.toggle("ignore");
            }
        
        function toggleSidebar() {
            document.getElementById('s-m').classList.toggle('visible');
            document.getElementById('s-m').classList.toggle('collapse');
            }
    
        function openAddForm() {
            document.getElementById('add-loan-form').classList.toggle('visible');
            document.getElementById('add-loan-form').classList.toggle('collapse');
            toggleSidebar()

            }

        function openEditForm() {
            document.getElementById('edit-loan-form').classList.toggle('visible');
            document.getElementById('edit-loan-form').classList.toggle('collapse');
            toggleSidebar()
        }

        function openPaymentForm() {
            document.getElementById('make-payment-form').classList.toggle('visible');
            document.getElementById('make-payment-form').classList.toggle('collapse');
            toggleSidebar()
        }

        function goBack(openForm) {
            openForm
        }
        
        function onlyNumberKey(evt) {
            // Only ASCII character in that range allowed
            var ASCIICode = (evt.which) ? evt.which : evt.keyCode
            if (ASCIICode > 31 && (ASCIICode < 48 || ASCIICode > 57))
                return false;
            return true;
        }

        function formatToUSD(value) {
            let number = parseFloat(value);
            if (isNaN(number)) {
                return "";
            }
            // Format number with commas and two decimal places
            return "$" + number.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        }

        function formatToPercentage(value) {
            let number = parseFloat(value);
            if (isNaN(number)) {
                return "";
            }
            // Format number to two decimal places with percent sign
            return number.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + "%";
        }

        function formatInput(event) {
            const input = event.target;
            const value = input.value.replace(/,/g, ''); // Remove commas for proper formatting
            const formatType = input.dataset.format; // Determine format type using data attribute

            let formattedValue;
            if (formatType === "usd") {
                formattedValue = formatToUSD(value);
            } else if (formatType === "percentage") {
                formattedValue = formatToPercentage(value);
            }

            // Find the corresponding <span> element to update
            const formattedSpan = input.nextElementSibling;
            formattedSpan.innerText = formattedValue;
        }

    </script>
</head>

<body>
    {% if session["user_id"] %} 
    <div class="header flex-center">    
    {% else %}
    <div class="header login-header flex-center"> 
    {% endif %}  

    {% block header %}{% endblock %}  

    </div>
    <div class="main">
    {% block welcome %}{% endblock %}

    {% with messages = g.flashed_messages %}
        {% if messages %}
            <ul class="flashes">
            {% for category, message in messages %}
                <li class="alert alert-{{ category }} h3" role="alert">
                    {{ message }}
                </li>
            {% endfor %}
            </ul>
        {% endif %}
    {% endwith %}
    
        {% block main %}
            {% block sidebar %}
            {% endblock %}
        {% endblock %}
    </div>
    <footer>
        <p>Wisp by Evan Hedgecock</p>
    </footer>
    
</body>

</html>